<div id="projects-deliverables">
    <h2>Deliverables <div class="right">
            <button ng-click="showmepm()"  ng-show="showmepmbutton">Show me as Responsible</button>
            <button ng-click="clearmepm()"  ng-show="!showmepmbutton">Clear me as Responsible</button>
            <button ng-click="showmepo()"  ng-show="showmepobutton">Show me as Approver</button>
            <button ng-click="clearmepo()"  ng-show="!showmepobutton">Clear me as Approver</button>
        <button ng-click="showfilters=true"  ng-show="!showfilters">Show filters</button><button ng-click="showfilters=false"  ng-show="showfilters">Hide filters</button></div></h2>
    <div class="smaller">
        <h3 ng-show="showfilters">Project filters</h3>
        <div class="filter-order-container" ng-show="showfilters">
            
            <div class="label" style="height:120px;">
                Filter by:<br/>BU<br/>Project<br/>State<br/>Type<br/>Portfolio
            </div>
            <div class="field multiple-select">
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.buname" ng-options="bu.name as bu.name for bu in bus | orderBy: 'name'"></select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.projecttitle" ng-options="p.title as p.title for p in projects | filter:{state: '!Closed'} | orderBy: 'title'"></select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.pstate" ng-init="milesearch.pstate=['Progress']">
                    <option value="Proposed">Proposed</option>
                    <option value="Progress">Progress</option>
                    <option value="Onhold">On hold</option>
                    <option value="Closed">Closed</option>
                </select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.ptype">
                    <option value="Project">Project</option>
                    <option value="Program">Program</option>
                    <option value="Product">Product</option>
                </select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.support" ng-options="bu.name as bu.name for bu in bus | orderBy: 'name'"></select>
                
            </div>
        </div>
        <h3 ng-show="showfilters">Deliverables filters</h3>
        <div class="filter-order-container" ng-show="showfilters">
            
            <div class="label" style="height:120px;">
                Filter by:<br/>Approver<br/>Responsible<br/>Type
            </div>
            <div class="field multiple-select">
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.acname" ng-options="u.name as u.name for u in users | filter: {source: true} | orderBy:'name'"></select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.resname" ng-options="u.name as u.name for u in users | filter: {source: true} | orderBy:'name'" ></select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.type" ng-init="milesearch.type=['Milestone', 'Go-live']">
                        <option value="Milestone">Milestone</option>
                        <option value="Phase">Phase</option>
                        <option value="Task">Task</option>
                        <option value="Go-live">Go-live</option>
                        <option value="Valuable">Valuable</option>
                </select>
            </div>
        </div>
        <div class="filter-order-container" ng-show="showfilters">
            <div class="label" style="height:120px;">
                Filter by:<br/>Status<br/>State<br/>Audience
            </div>
            <div class="field multiple-select">
                
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.status" ng-init="milesearch.status=['Red','Orange']">
                    <option value="Green">Accept</option>
                    <option value="Yellow">Observe</option>
                    <option value="Orange">Assist</option>
                    <option value="Red">Intervent</option>
                </select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.state">
                    <option value="Target">Target</option>
                    <option value="Qualified">Qualified</option>
                    <option value="Progress">Progress</option>
                </select>
                <select multiple="multiple" ng-multiple="true" ng-model="milesearch.audience" ng-init="milesearch.audience=['Company','Portfolio']">
                    <option value="Project">Project</option>
                    <option value="Portfolio">Portfolio</option>
                    <option value="Company">Company</option>
                </select>
                
            </div>
        </div>
        <div class="filter-order-container" ng-show="showfilters">
            <div class="label">
                Order by:
            </div>
            <div class="field">
                <select ng-model="orderdate" ng-init="orderdate='enddate'">
                    <option value="enddate" selected="selected">Order by end date</option>
                    <option value="date">Order by start date</option>
                    <option value="-wsjf">Order by WSJF</option>
                    <option value="title">Deliverable title</option>
                    <option value="projecttitle">Project title</option>
                </select>
            </div>
        </div>
        <div class="overview">
            <table class="tablelist" ng-if="milestoneList.length > 0">
                <tr class="header">
                    <td>(WSJF) Deliverable<br/>Project</td>
                    <td>2017</td>
                    <td>2018</td>
                    <td>2019</td>
                    <td>Start Date<br/>End Date</td>
                    <td>Responsible<br/>Approver</td>
                </tr>
                <tr ng-repeat="mile in milestoneList | multiFilter:milesearch | orderBy:orderdate" ng-click="goToMilestoneInProject(mile._id, mile.projectid)"
                    class="link" ng-if="mile.state!='Done' && mile.state!='Canceled'">
                    <td class="{{mile.status}}"><b>({{mile.wsjf}}) {{mile.title}}</b><br/>{{mile.projecttitle}}</td>
                    <td class="bar" ng-style="barRender(mile)" colspan="3">{{mile.type}}/{{mile.state}}</td>
                    <td><b>{{mile.date | date:'d MMM, yyyy'}}</b><br/>{{mile.enddate | date:'d MMM, yyyy'}}</td>
                    <td><b>{{mile.responsible.name}}</b><br/>{{mile.acountable.name}}</td>
                </tr>
            </table>
        </div>
    </div>
</div>